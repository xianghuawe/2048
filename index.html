<!DOCTYPE html>
<!--
  ~ Copyright (c) 2018. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  ~ Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
  ~ Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
  ~ Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
  ~ Vestibulum commodo. Ut rhoncus gravida arcu.
  -->

<html>

<head>
    <meta charset="utf-8"/>
    <title></title>
    <link rel="stylesheet" href="css/main.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
</head>
<body>
<div id="msg"></div>
<div class="mask">
</div>
<div class="form">
    <h2>您本次最高分为<span id="max-score" style="color: red;">0</span>!</h2>
    <p><label for="nickname">留下您的大名，让江湖人尽皆知吧！</label><input type="text" id="nickname"></p>
    <p><a class="btn-submit" href="javascript:void(0)" onclick="no_cookies_name_submit()">昭告天下</a></p>
</div>
<div class="header">
    <p id="message_label"></p>
</div>

<div class="body">
    <div class="tab_additional">
        <a href="javascript:gamestart()" class="start">开始</a>
        <label>当前步数</label>
        <span id="step_round">0</span><label>总步数</label>
        <span id="step_all">0</span>
    </div>
    <div id="container" class="container">
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
    </div>
    <div class="right">
        <h5>排行榜</h5>
        <ul>
            <li></li>
        </ul>
    </div>
</div>
</body>
<script src="js/2048.src.js" type="text/javascript"></script>
<script src="js/tool.cookie.js" type="text/javascript"></script>
<script type="text/javascript">
    function gamestart() {
        var game_box = document.getElementById('container');
        gamer_factory.init(game_box, "{'count_round':'step_round','count_all':'step_all','error_label':'message_label','level':1}");
    }

    gamer_factory.end = function () {
        return false;
        if (getCookie('cc_2048_username')) {
            //本次存储有用户名
            var data = '';
            data += 'username=' + getCookie('cc_2048_username') + '&score=' + gamer_factory.max()
                + '&step=' + gamer_factory.step_round;
            var ajax_obj = getAjaxObject();
            ajax_obj.onstatechange = function (ev) {

            }
            post(ajax_obj, '/2048/info_cal_in.php', data);

        } else {
            document.getElementsByClassName('mask')[0].style.display = 'block';
            document.getElementsByClassName('form')[0].style.display = 'block';
        }
    }

    function showError(str) {
        var msgobj = document.getElementById('msg');
        msgobj.innerHTML = str;
        msgobj.style.display = 'block';
        setTimeout(function () {
            msgobj.style.display = 'none';
        }, 3000)
    }

    function no_cookies_name_submit() {
        var username = document.getElementById('nickname').value.replace(/(^\s*)|(\s*$)/g, '');
        if (typeof username != 'string' || username === '') {
            showError('请阁下告知您的大名，好让我们铭记于心。')
        }
        setCookie('cc_2048_username', username, 360);
        var data = '';
        data += 'username=' + getCookie('cc_2048_username') + '&score=' + gamer_factory.max()
            + '&step=' + gamer_factory.step_round;
        var ajax_obj = getAjaxObject();
        ajax_obj.onstatechange = function () {
            if (ajax_obj.readyState === 4 && ajax_obj.status === 200) {
                var res = xmlhttp.responseText;
                if (res !== '') {

                }
                try {
                    setCookie('uuid', res)
                } catch (e) {

                }
            }
        };
        post(ajax_obj, '/2048/info_cal_in.php', data);
    }



</script>

</html>