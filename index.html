<!DOCTYPE html>
<!--
  ~ Copyright (c) 2018. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  ~ Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
  ~ Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
  ~ Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
  ~ Vestibulum commodo. Ut rhoncus gravida arcu.
  -->

<html>

<head>
    <meta charset="utf-8"/>
    <title></title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        .container {
            margin: 0 auto;
            width: 302px;
            height: 302px;
            overflow: hidden;
            background-color: #e7eac875;
            float: left;
        }

        .container .item {
            width: 100px;
            height: 100px;
            line-height: 100px;
            float: left;
            text-align: center;
            font-size: 30px;
            color: #5a5555;
            border-bottom: 1px solid white;
        }

        .container .item:nth-child(3n+2) {
            border-left: 1px solid white;
            border-right: 1px solid white;
        }

        .header {
            margin: 0 auto;
            text-align: center;
            height: 60px;
        }

        .body {
            width: 80%;
            margin: 0 10%;
            min-width: 700px;
            overflow: hidden;
        }

        .tab_additional {
            width: 100%;
            text-align: left;
            padding-bottom: 10px;
            padding-top: 10px;
        }

        .start {
            padding: 5px 15px;
            color: #FFFFFF;
            background-color: green;
            border-radius: 6px;
            text-decoration: none;
        }

        .start:hover {
            background-color: darkgreen;
        }

        .right {
            width: 20%;
            float: right;
        }

        .right ul {
            list-style: none;
        }

        .mask {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #cecece;
            position: fixed;
            opacity: 0.8;
            display: none;
        }

        .form {
            display: none;
            width: 50%;
            min-width: 500px;
            position: absolute;
            padding-top: 60px;
            margin: 0 25%;
            text-align: center;
            z-index: 7;
            background-color: #fff;
        }

        .form h2 {
            padding-bottom: 15px;
        }

        .form p {
            padding: 5px 0;
        }

        .form p input {
            outline: unset;
            border: none;
            background-color: #fd0000;
            height: 25px;
            color: yellow;
            line-height: 25px;
            border-radius: 6px;
            text-align: center;
        }

        .form .btn-submit {
            padding: 10px 30px;
            display: inline-block;
            background-color: #fd0000;
            text-decoration: none;
            color: yellow;
            border-radius: 7px;
        }

        #msg {
            display: none;
            position: fixed;
            top: 10px;
            right: 10px;
            background: #0d86c1;
            color: #fff;
            padding: 10px;
            max-width: 130px;
            z-index: 1;
        }
    </style>
</head>
<body>
<div id="msg"></div>
<div class="mask">
</div>
<div class="form">
    <h2>您本次最高分为<span id="max-score" style="color: red;">0</span>!</h2>
    <p><label for="nickname">留下您的大名，让江湖人尽皆知吧！</label><input type="text" id="nickname"></p>
    <p><a class="btn-submit" href="javascript:void(0)" onclick="no_cookies_name_submit()">昭告天下</a></p>
</div>
<div class="header">
    <p id="message_label"></p>
</div>

<div class="body">
    <div class="tab_additional">
        <a href="javascript:gamestart()" class="start">开始</a>
        <label>当前步数</label>
        <span id="step_round">0</span><label>总步数</label>
        <span id="step_all">0</span>
    </div>
    <div id="container" class="container">
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
    </div>
    <div class="right">
        <h5>排行榜</h5>
        <ul>
            <li></li>
        </ul>
    </div>
</div>
</body>
<script src="js/2048.src.js" type="text/javascript"></script>
<script src="js/tool.cookie.js" type="text/javascript"></script>
<script type="text/javascript">
    function gamestart() {
        var game_box = document.getElementById('container');
        gamer_factory.init(game_box, "{'count_round':'step_round','count_all':'step_all','error_label':'message_label','level':1}");
    }

    gamer_factory.end = function () {
        return false;
        if (getCookie('cc_2048_username')) {
            //本次存储有用户名
            var data = '';
            data += 'username=' + getCookie('cc_2048_username') + '&score=' + gamer_factory.max()
                + '&step=' + gamer_factory.step_round;
            var ajax_obj = getAjaxObject();
            ajax_obj.onstatechange = function (ev) {

            }
            post(ajax_obj, '/2048/info_cal_in.php', data);

        } else {
            document.getElementsByClassName('mask')[0].style.display = 'block';
            document.getElementsByClassName('form')[0].style.display = 'block';
        }
    }

    function showError(str) {
        var msgobj = document.getElementById('msg');
        msgobj.innerHTML = str;
        msgobj.style.display = 'block';
        setTimeout(function () {
            msgobj.style.display = 'none';
        }, 3000)
    }

    function no_cookies_name_submit() {
        var username = document.getElementById('nickname').value.replace(/(^\s*)|(\s*$)/g, '');
        if (typeof username != 'string' || username === '') {
            showError('请阁下告知您的大名，好让我们铭记于心。')
        }
        setCookie('cc_2048_username',username,360);
        var data = '';
        data += 'username=' + getCookie('cc_2048_username') + '&score=' + gamer_factory.max()
            + '&step=' + gamer_factory.step_round;
        var ajax_obj = getAjaxObject();
        ajax_obj.onstatechange = function () {
            if (ajax_obj.readyState===4 && ajax_obj.status===200)
            {
                var res =xmlhttp.responseText;
                if(res!=='')
                {

                }
                try{
                    setCookie('uuid',res)
                }catch (e){

                }
            }
        };
        post(ajax_obj, '/2048/info_cal_in.php', data);
    }
</script>

</html>